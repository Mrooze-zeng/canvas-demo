(this["webpackJsonpcanvas-demo"]=this["webpackJsonpcanvas-demo"]||[]).push([[0],{20:function(t,i,e){},24:function(t,i,e){},25:function(t,i,e){"use strict";e.r(i);var s=e(5),h=e.n(s),a=e(15),n=e.n(a),o=e(1),r=(e(20),e(2)),c=e(3),u=function(){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=i.lt,s=void 0===e?{}:e,h=i.rt,a=void 0===h?{}:h,n=i.rb,o=void 0===n?{}:n,c=i.lb,u=void 0===c?{}:c;Object(r.a)(this,t),this.lt=s,this.rt=a,this.rb=o,this.lb=u}return Object(c.a)(t,[{key:"setLTRB",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.lt,e=void 0===i?{}:i,s=t.rt,h=void 0===s?{}:s,a=t.rb,n=void 0===a?{}:a,o=t.lb,r=void 0===o?{}:o;this.lt=e,this.rt=h,this.rb=n,this.lb=r}},{key:"updateL",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};this.lt=t}},{key:"updateT",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};this.lt=t}},{key:"updateR",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};this.lt=t}},{key:"updateB",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};this.lt=t}}]),t}(),d=e(7),l=e.n(d);var v=function(t){return new(new Map([[O.name,O],[R.name,R],[f.name,f]]).get(t.constructor.name))(l.a.cloneDeep(t.toJSON()))};var p=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"lightgray",h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;t.lineWidth=h;for(var a=h,n=0;a<t.canvas.width;a+=i,n++)t.beginPath(),t.moveTo(a,0),t.lineTo(a,t.canvas.height),t.strokeStyle=n%5===0?"darkgrey":s,t.stroke();for(var o=h,r=0;o<t.canvas.height;o+=e,r++)t.beginPath(),t.moveTo(0,o),t.lineTo(t.canvas.width,o),t.strokeStyle=r%5===0?"darkgrey":s,t.stroke()};var g=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};t.beginPath(),t.strokeStyle="#59c7f9",t.moveTo(i.x,i.y),t.lineTo(e.x,i.y),t.lineTo(e.x,e.y),t.lineTo(i.x,e.y),t.closePath(),t.stroke()},y=function(){var t=0;return function(){return t++}}();new Map([["linear-gradient",R],["radial-gradient",O]]);var x=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=new RegExp(/background-image:\s?([0-9a-z\-\s#(),%]*);/gi),e=new RegExp(/background-size:\s?([0-9a-z\s,%]*);/gi),s=new RegExp(/background-position:\s?([0-9a-z\s,%]*);/gi),h=new RegExp(/(linear|radial)-gradient\(([\s0-9a-z%,#]*)\){1}/gi),a=new RegExp(/radial-gradient\(([\s0-9a-z%,#]*)\){1}/gi),n=new RegExp(/,\s?[0-9a-z#]*\s\d/gi),r=new RegExp(/circle\s([0-9a-z]*)\sat/gi),c=new RegExp(/linear-gradient\(([\s0-9a-z%,#]*)\){1}/gi),u=new RegExp(/inear-gradient\(\s?([0-9a-z#]*)\s\d/gi),d=i.exec(t)||[],l=Object(o.a)(d,2),v=(l[0],l[1]),p=void 0===v?"":v,g=e.exec(t)||[],y=Object(o.a)(g,2),x=(y[0],y[1]),f=void 0===x?"":x,b=s.exec(t)||[],S=Object(o.a)(b,2),k=(S[0],S[1]),w=void 0===k?"":k,j=p.match(h)||[],m=new P;return w=w.replace(/[^\d^\s,]/g,"").split(","),f=f.replace(/[^\d^\s,]/g,"").split(","),j.forEach((function(t,i){var e;if(t.match(a)){var s=t.match(n)||[],h=Object(o.a)(s,1)[0],d=void 0===h?"":h,l=t.match(r)||[],v=Object(o.a)(l,1)[0],p=w[i].trim().split(/\s/),g=Object(o.a)(p,2),y=g[0],x=g[1];v=Number(v.replace(/[^\d]/g,"")),e=new O({color:d.replace(/,|\d|\s/g,""),pos:{x:Number(y)+v,y:Number(x)+v},radius:v})}if(t.match(c)){var b=t.match(u)||[],S=Object(o.a)(b,1)[0],k=void 0===S?"":S,j=w[i].trim().split(/\s/),M=Object(o.a)(j,2),A=M[0],z=M[1],P=f[i].trim().split(/\s/),E=Object(o.a)(P,2),B=E[0],C=E[1];e=new R({color:k.replace(/,|\d|\s|inear-gradient\(/g,""),pos:{x:Number(A),y:Number(z)},width:Number(B),height:Number(C)}),console.log(e)}m.add(e)})),m},f=function(){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=i.color,s=void 0===e?"lightgray":e,h=i.activeColor,a=void 0===h?"rgb(89 199 249)":h,n=i.pos,o=void 0===n?{x:0,y:0}:n,c=i.isActive,d=void 0!==c&&c,l=i.isSelected,v=void 0!==l&&l;Object(r.a)(this,t),this.id=y(),this.pos=o,this.color=s,this.activeColor=a,this.isActive=d,this.isSelected=v,this.resizeDirection=new j,this.anchor=new u,this.lineWidth=2,this.origin=null}return Object(c.a)(t,[{key:"setOrigin",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.origin=null,t&&(this.origin=v(this))}},{key:"setActive",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isActive=t}},{key:"setSelected",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isSelected=t}},{key:"toggleSelected",value:function(){this.isSelected=!this.isSelected,this.updateActiveStatus(this.isSelected),console.log(this.isActive,this.isSelected)}},{key:"movePos",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.updatePos({x:this.pos.x-t,y:this.pos.y-i})}},{key:"updatePos",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};this.pos=t}},{key:"updateActiveStatus",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isActive=t}},{key:"updateSize",value:function(){}},{key:"resize",value:function(){}},{key:"isCursorOnShape",value:function(){}},{key:"isShapeOnArea",value:function(){}},{key:"getActiveSide",value:function(){}},{key:"_calculateBoundary",value:function(t){var i=this.pos.x,e=this.pos.y;return[new j,{x:i,y:e}]}},{key:"_setBoundary",value:function(t){var i=this._calculateBoundary(t),e=Object(o.a)(i,2),s=e[0],h=s.l,a=s.t,n=s.r,r=s.b,c=e[1];(h||a||n||r)&&this.updatePos(c)}},{key:"getAnchorPoint",value:function(){}},{key:"render",value:function(){}},{key:"parseStyle",value:function(){return""}},{key:"toJSON",value:function(){return{}}}]),t}(),b=e(9),S=e(6),k=e(12),w=e(11),O=function(t){Object(k.a)(e,t);var i=Object(w.a)(e);function e(t){var s;return Object(r.a)(this,e),(s=i.call(this,t)).radius=t.radius,s}return Object(c.a)(e,[{key:"resize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.origin){var i=this.origin.resizeDirection,e=i.l,s=i.t,h=i.r,a=i.b;e&&this.updateSize({radius:this.origin.radius+(this.origin.pos.x-t.x)}),s&&this.updateSize({radius:this.origin.radius+(this.origin.pos.y-t.y)}),h&&this.updateSize({radius:this.origin.radius+(t.x-this.origin.pos.x)}),a&&this.updateSize({radius:this.origin.radius+(t.y-this.origin.pos.y)})}}},{key:"updatePos",value:function(t){t.x-this.radius<=0?this.pos.x=this.radius:t.y-this.radius<=0?this.pos.y=this.radius:Object(b.a)(Object(S.a)(e.prototype),"updatePos",this).call(this,t)}},{key:"updateSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.radius,e=void 0===i?0:i;this.radius=e}},{key:"isCursorOnShape",value:function(t){var i=t.x,e=void 0===i?0:i,s=t.y,h=void 0===s?0:s;return!(e<=this.pos.x-this.radius||e>=this.pos.x+this.radius)&&!(h<=this.pos.y-this.radius||h>=this.pos.y+this.radius)}},{key:"isShapeOnArea",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0};return!(Math.min(t.x,i.x)>this.pos.x+this.radius||Math.max(t.x,i.x)<this.pos.x)&&!(Math.min(t.y,i.y)>this.pos.y+this.radius||Math.max(t.y,i.y)<this.pos.y)}},{key:"getActiveSide",value:function(t){var i=t.x,e=void 0===i?0:i,s=t.y,h=void 0===s?0:s,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.resizeDirection.setLTRB({l:Math.abs(e-this.pos.x+this.radius)<this.lineWidth+a,r:Math.abs(e-this.pos.x-this.radius)<this.lineWidth+a,t:Math.abs(h-this.pos.y+this.radius)<this.lineWidth+a,b:Math.abs(h-this.pos.y-this.radius)<this.lineWidth+a}),Math.abs(e-this.pos.x-this.radius)<this.lineWidth+a||Math.abs(e-this.pos.x+this.radius)<this.lineWidth+a||Math.abs(h-this.pos.y-this.radius)<this.lineWidth+a||Math.abs(h-this.pos.y+this.radius)<this.lineWidth+a}},{key:"_calculateBoundary",value:function(t){var i=Object(b.a)(Object(S.a)(e.prototype),"_calculateBoundary",this).call(this,t),s=Object(o.a)(i,2),h=s[0],a=s[1],n=a.x,r=a.y,c=t.canvas.width,u=t.canvas.height;h.setLTRB({l:this.pos.x-this.radius<=0,t:this.pos.y-this.radius<=0,r:this.pos.x+this.radius>=c,b:this.pos.y+this.radius>=u});var d=h.l,l=h.t,v=h.r,p=h.b;return d&&(n=this.radius),l&&(r=this.radius),v&&(n=t.canvas.width-this.radius),p&&(r=t.canvas.height-this.radius),[h,{x:n,y:r}]}},{key:"_calculateMaxAndMin",value:function(t){this.origin&&(this.pos.x-this.radius<=0&&(this.radius=this.pos.x),this.pos.y-this.radius<=0&&(this.radius=this.pos.y),(2*this.radius>=t.canvas.width||2*this.radius>=t.canvas.height)&&(this.radius=t.canvas.width/2),this.radius<=10&&(this.radius=10))}},{key:"getAnchorPoint",value:function(){return this.anchor.setLTRB({lt:{x:this.pos.x-this.radius,y:this.pos.y-this.radius},rt:{x:this.pos.x+this.radius,y:this.pos.y-this.radius},rb:{x:this.pos.x+this.radius,y:this.pos.y+this.radius},lb:{x:this.pos.x-this.radius,y:this.pos.y+this.radius}}),this.anchor}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._calculateMaxAndMin(t),this._setBoundary(t),t.save(),t.lineWidth=this.lineWidth,t.strokeStyle=this.color,t.fillStyle=this.color,t.beginPath(),t.arc(this.pos.x,this.pos.y,this.radius,0,2*Math.PI),t.closePath(),t.fill(),this.isSelected&&(t.save(),t.strokeStyle=this.activeColor,t.beginPath(),t.rect(this.pos.x-this.radius,this.pos.y-this.radius,2*this.radius,2*this.radius),t.closePath(),t.stroke()),t.restore()}},{key:"parseStyle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.x,e=void 0===i?0:i,s=t.y,h=void 0===s?0:s;return{backgroundImage:"radial-gradient( circle ".concat(this.radius,"px at ").concat(this.radius,"px ").concat(this.radius,"px, ").concat(this.color," 100%, transparent 0 )"),backgroundPosition:"".concat(this.pos.x-this.radius-e,"px ").concat(this.pos.y-this.radius-h,"px"),backgroundSize:"".concat(2*this.radius,"px ").concat(2*this.radius,"px")}}},{key:"toJSON",value:function(){return{pos:this.pos,color:this.color,activeColor:this.activeColor,isActive:this.isActive,isSelected:this.isSelected,radius:this.radius}}}]),e}(f),j=function(){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=i.l,s=void 0!==e&&e,h=i.t,a=void 0!==h&&h,n=i.r,o=void 0!==n&&n,c=i.b,u=void 0!==c&&c;Object(r.a)(this,t),this.l=s,this.t=a,this.r=o,this.b=u}return Object(c.a)(t,[{key:"setLTRB",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.l,e=void 0!==i&&i,s=t.t,h=void 0!==s&&s,a=t.r,n=void 0!==a&&a,o=t.b,r=void 0!==o&&o;this.l=e,this.t=h,this.r=n,this.b=r,this.setCursorType()}},{key:"setCursorType",value:function(){this.direction="",(this.l||this.r)&&(this.direction="ew"),(this.t||this.b)&&(this.direction="ns")}}]),t}(),m=e(14),M=e(0),A=function(t){var i=t.onClick,e=void 0===i?function(){}:i,h=t.onSetShapes,a=void 0===h?function(){}:h,n={text:"",style:{},width:"100%",height:"100%"},r=Object(s.useState)(n),c=Object(o.a)(r,2),u=c[0],d=c[1];return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("button",{onClick:function(){var t=e();console.log(t),d(t)},children:"\u8f93\u51fa"}),Object(M.jsx)("button",{onClick:function(){d(n)},children:"\u6e05\u7a7a"}),Object(M.jsx)("button",{onClick:function(){var t=window.prompt("\u8bf7\u586b\u5165\u6837\u5f0f\u4ee3\u7801")||"";(t=t.replace(/\r|\n|\s{2}/g,""))&&a(x(t))},children:"\u5bfc\u5165"}),Object(M.jsxs)("div",{style:{width:800,height:window.innerHeight,position:"relative"},children:[Object(M.jsx)("div",{className:"output",style:Object(m.a)(Object(m.a)({},u.style),{},{width:u.width,height:u.height,backgroundRepeat:"no-repeat",position:"relative"})}),Object(M.jsx)("pre",{children:Object(M.jsx)("code",{children:u.text&&function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"\n        width: ".concat(u.width,",\n        height: ").concat(u.height,',\n        overflow: hidden;\n        background-repeat: "no-repeat",\n        position: "relative",').concat(t,'\n        &:before {\n            content: "";\n            width: 100%;\n            height: 100%;\n            display: inline-block;\n            position: relative;\n            top: 0;\n            left: -100%;\n            background-image: linear-gradient(\n              100deg,\n              rgba(255, 255, 255, 0),\n              rgba(255, 255, 255, 0.5) 50%,\n              rgba(255, 255, 255, 0) 80%\n            );\n            animation: shine 1s infinite;\n        }\n        @keyframes shine {\n            to {\n              left: 100%;\n            }\n        }\n    ')}(u.text)})})]})]})},z=e(4),P=function(){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(r.a)(this,t),this.shapes=i,this.activeShape=new f,this.selectedShapes=[],this.isDisableActiveShapes=!1}return Object(c.a)(t,[{key:"setOriginActiveShape",value:function(){this.activeShape.setOrigin(!0)}},{key:"removeOriginActiveShape",value:function(){this.activeShape.setOrigin(!1)}},{key:"setDisableActiveShapes",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isDisableActiveShapes=t}},{key:"selectShapesOnActiveArea",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&this.shapes.forEach((function(e){e.setSelected(e.isShapeOnArea(t,i))})),e&&this.getSelectedShapes()}},{key:"updatePos",value:function(){this.getSelectedShapes().forEach((function(t){}))}},{key:"updateShapes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.shapes=t}},{key:"calculateActiveShape",value:function(){var t=arguments.length>1?arguments[1]:void 0,i=t.x,e=void 0===i?0:i,s=t.y,h=void 0===s?0:s,a=[];if(this.activeShape=new f,this.isDisableActiveShapes||this.shapes.forEach((function(t){t.updateActiveStatus(!1),t.isCursorOnShape({x:e,y:h})&&a.push(t)})),a.length){var n=a[a.length-1];n.updateActiveStatus(!0),this.activeShape=n}return this.activeShape}},{key:"setActiveShape",value:function(t){this.resetShapeStatus(),t.updateActiveStatus(!0),this.activeShape=t}},{key:"resetShapeStatus",value:function(){this.shapes.forEach((function(t){t.updateActiveStatus(!1)}))}},{key:"getActiveShape",value:function(){return this.activeShape}},{key:"hasActiveShape",value:function(){return"Base"!==this.activeShape.constructor.name}},{key:"hasSelectedShape",value:function(){return this.getSelectedShapes().length>0}},{key:"setSelectedShapes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t?this.activeShape.toggleSelected():(this.resetSelectedShapes(),this.activeShape.setSelected()),this.selectedShapes=this.getSelectedShapes()}},{key:"getSelectedShapes",value:function(){return this.selectedShapes=this.shapes.filter((function(t){return t.isSelected})),this.selectedShapes}},{key:"resetSelectedShapes",value:function(){this.shapes.forEach((function(t){t.setSelected(!1)}))}},{key:"getSpaceTakenUp",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=[],e=[];return t.forEach((function(t){var s=t.getAnchorPoint(),h=s.lt,a=s.rt,n=s.lb;i=i.concat([h.x,a.x]),e=e.concat([h.y,n.y])})),{anchor:new u({lt:{x:Math.min.apply(Math,Object(z.a)(i)),y:Math.min.apply(Math,Object(z.a)(e))},rt:{x:Math.max.apply(Math,Object(z.a)(i)),y:Math.min.apply(Math,Object(z.a)(e))},rb:{x:Math.max.apply(Math,Object(z.a)(i)),y:Math.max.apply(Math,Object(z.a)(e))},lb:{x:Math.min.apply(Math,Object(z.a)(i)),y:Math.max.apply(Math,Object(z.a)(e))}}),width:Math.max.apply(Math,Object(z.a)(i))-Math.min.apply(Math,Object(z.a)(i)),height:Math.max.apply(Math,Object(z.a)(e))-Math.min.apply(Math,Object(z.a)(e))}}},{key:"isGroupReachBoundary",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=this.getSpaceTakenUp(t),h=s.anchor;return Math.min(h.lb.x,h.lt.x,h.rb.x,h.rt.x)<0||Math.min(h.lb.y,h.lt.y,h.rb.y,h.rt.y)<0||Math.max(h.lb.x,h.lt.x,h.rb.x,h.rt.x)>i||Math.max(h.lb.y,h.lt.y,h.rb.y,h.rt.y)>e}},{key:"parseStyle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=[],e=[],s=[],h=this.getSpaceTakenUp(this.shapes),a=h.anchor.lt,n=h.width,o=h.height,r=t?{x:0,y:0}:a;return this.shapes.forEach((function(h){var n=h.parseStyle(t?a:{});i.unshift(n.backgroundImage),e.unshift(n.backgroundPosition),s.unshift(n.backgroundSize)})),{text:"\n        background-image: ".concat(i.join(","),";\n        background-position: ").concat(e.join(","),";\n        background-size: ").concat(s.join(","),";    \n            "),style:{backgroundImage:i.join(","),backgroundPosition:e.join(","),backgroundSize:s.join(",")},width:"".concat(n+r.x,"px"),height:"".concat(o+r.y,"px")}}},{key:"render",value:function(t){t.clearRect(0,0,t.canvas.width,t.canvas.height),p(t),this.shapes.forEach((function(i){i.render(t)}))}},{key:"copy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.resetSelectedShapes(),this.shapes=this.shapes.concat(t)}},{key:"delete",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[new f];this.shapes=this.shapes.filter((function(i){return t.findIndex((function(t){return t.id===i.id}))<0}))}},{key:"add",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new f;return this.shapes.unshift(t)}}]),t}(),E=function(){function t(i){var e=i.ctx,s=i.shapes,h=void 0===s?new P:s;Object(r.a)(this,t),this.ctx=e,this.shapes=h,this.copiedShape=null}return Object(c.a)(t,[{key:"_handleKeyDown",value:function(t){this[t.code]&&t.metaKey&&(l.a.throttle(this[t.code].bind(this),50)(t),this.shapes.render(this.ctx),t.preventDefault(),t.stopPropagation())}},{key:"setShortKeys",value:function(){window.addEventListener("keydown",this._handleKeyDown.bind(this),!1)}},{key:"removeShortKeys",value:function(){window.removeEventListener("keydown",this._handleKeyDown.bind(this),!1),this.copiedShapes=[]}},{key:"_isReachBoundary",value:function(){return this.shapes.isGroupReachBoundary(this.shapes.getSelectedShapes(),this.ctx.canvas.width,this.ctx.canvas.height)}},{key:"Backspace",value:function(t){this.shapes.hasSelectedShape()&&this.shapes.delete(this.shapes.getSelectedShapes())}},{key:"KeyC",value:function(t){this.shapes.hasSelectedShape()&&(this.copiedShapes=this.shapes.getSelectedShapes())}},{key:"KeyV",value:function(t){if(this.copiedShapes.length){var i=[];this.copiedShapes.forEach((function(t){var e=v(t);e.pos.x+=10,e.pos.y+=10,i.push(e)})),this.shapes.copy(i),this.copiedShapes=i}}},{key:"ArrowUp",value:function(t){!this._isReachBoundary()&&this.shapes.getSelectedShapes().forEach((function(t){t.pos.y-=1}))}},{key:"ArrowRight",value:function(t){!this._isReachBoundary()&&this.shapes.getSelectedShapes().forEach((function(t){t.pos.x+=1}))}},{key:"ArrowDown",value:function(t){!this._isReachBoundary()&&this.shapes.getSelectedShapes().forEach((function(t){t.pos.y+=1}))}},{key:"ArrowLeft",value:function(t){!this._isReachBoundary()&&this.shapes.getSelectedShapes().forEach((function(t){t.pos.x-=1,t.pos.x}))}}]),t}();var B=function(t){var i=t.shapes,e=void 0===i?new P:i,h=Object(s.useRef)(),a=!1,n=l.a.throttle((function(t){var i=t.target.getBoundingClientRect(),s=i.x,n=i.y,o=t.clientX,r=t.clientY,c=h.current.getContext("2d"),u={x:o-s,y:r-n},d=e.calculateActiveShape(c,u);a||(d.getActiveSide(u,2)?h.current.style.cursor=d.resizeDirection.direction+"-resize":d.isActive?h.current.style.cursor="move":(h.current.style.cursor="default",t.preventDefault(),t.stopPropagation()))}),50);return Object(s.useEffect)((function(){var t=h.current.getContext("2d");e.render(t)})),Object(s.useEffect)((function(){var t=h.current.getContext("2d"),i=new E({ctx:t,shapes:e});return i.setShortKeys(),i.removeShortKeys()})),Object(M.jsx)("canvas",{width:800,height:window.innerHeight,ref:h,style:{width:800,height:window.innerHeight},onMouseMove:n,onMouseDown:function(t){t.preventDefault(),t.stopPropagation();var i=t.target.getBoundingClientRect(),s=i.x,n=i.y,o=t.clientX,r=t.clientY,c=h.current.getContext("2d"),u={x:o-s,y:r-n},d=e.getActiveShape(),l=0,v=0,p=d.isActive;e.setOriginActiveShape(),p&&(l=o-d.pos.x-s,v=r-d.pos.y-n),e.setSelectedShapes(t.metaKey);var y=function(t){t.preventDefault(),t.stopPropagation();var i={x:t.clientX-s-l,y:t.clientY-n-v};if(!p)return e.setDisableActiveShapes(),e.render(c),void g(c,u,i);a=!0,d.origin&&d.origin.getActiveSide(u,2)?d.resize(i,d.origin):d.updatePos(i),e.render(c)};document.addEventListener("mousemove",y),document.addEventListener("mouseup",(function t(i){var h={x:i.clientX-s-l,y:i.clientY-n-v};document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",t),a=!1,e.removeOriginActiveShape(),e.setDisableActiveShapes(!1),e.selectShapesOnActiveArea(u,h,!p),e.render(c),console.log(e.getSelectedShapes(),p)}))}})},R=function(t){Object(k.a)(e,t);var i=Object(w.a)(e);function e(t){var s;return Object(r.a)(this,e),(s=i.call(this,t)).width=t.width,s.height=t.height,s}return Object(c.a)(e,[{key:"resize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.origin){var i=this.origin.resizeDirection,e=i.l,s=i.t,h=i.r,a=i.b;e&&(this.updateSize({width:this.origin.width+(this.origin.pos.x-t.x),height:this.origin.height}),this.updatePos({x:t.x,y:this.origin.pos.y})),s&&(this.updateSize({width:this.origin.width,height:this.origin.height+(this.origin.pos.y-t.y)}),this.updatePos({x:this.origin.pos.x,y:t.y})),h&&this.updateSize({width:this.origin.width+(t.x-this.origin.pos.x),height:this.origin.height}),a&&this.updateSize({width:this.origin.width,height:this.origin.height+(t.y-this.origin.pos.y)})}}},{key:"updateSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.width,e=void 0===i?0:i,s=t.height,h=void 0===s?0:s;this.width=e,this.height=h}},{key:"isCursorOnShape",value:function(t){var i=t.x,e=void 0===i?0:i,s=t.y,h=void 0===s?0:s;return!(e<=this.pos.x||e>=this.pos.x+this.width)&&!(h<=this.pos.y||h>=this.pos.y+this.height)}},{key:"isShapeOnArea",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0};return!(Math.min(t.x,i.x)>this.pos.x+this.width||Math.max(t.x,i.x)<this.pos.x)&&!(Math.min(t.y,i.y)>this.pos.y+this.height||Math.max(t.y,i.y)<this.pos.y)}},{key:"getActiveSide",value:function(t){var i=t.x,e=void 0===i?0:i,s=t.y,h=void 0===s?0:s,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.resizeDirection.setLTRB({l:Math.abs(e-this.pos.x)<this.lineWidth+a,r:Math.abs(e-this.pos.x-this.width)<this.lineWidth+a,t:Math.abs(h-this.pos.y)<this.lineWidth+a,b:Math.abs(h-this.pos.y-this.height)<this.lineWidth+a}),Math.abs(e-this.pos.x)<this.lineWidth+a||Math.abs(e-this.pos.x-this.width)<this.lineWidth+a||Math.abs(h-this.pos.y)<this.lineWidth+a||Math.abs(h-this.pos.y-this.height)<this.lineWidth+a}},{key:"_calculateBoundary",value:function(t){var i=Object(b.a)(Object(S.a)(e.prototype),"_calculateBoundary",this).call(this,t),s=Object(o.a)(i,2),h=s[0],a=s[1],n=a.x,r=a.y,c=t.canvas.width,u=t.canvas.height;h.setLTRB({l:this.pos.x<=0,t:this.pos.y<=0,r:this.pos.x+this.width>=c,b:this.pos.y+this.height>=u});var d=h.l,l=h.t,v=h.r,p=h.b;return d&&(n=0),l&&(r=0),v&&(n=t.canvas.width-this.width),p&&(r=t.canvas.height-this.height),[h,{x:n,y:r}]}},{key:"_calculateMaxAndMin",value:function(t){if(this.origin){var i=this.origin.resizeDirection,e=i.l,s=i.t,h=i.r,a=i.b;h&&this.pos.x+this.width>=t.canvas.width&&(this.width=t.canvas.width-this.pos.x),a&&this.pos.y+this.height>=t.canvas.height&&(this.height=t.canvas.height-this.pos.y),e&&this.origin.pos.x+this.origin.width<=this.width&&(this.width=this.origin.pos.x+this.origin.width,this.pos.x=0),s&&this.origin.pos.y+this.origin.height<=this.height&&(this.height=this.origin.pos.y+this.origin.height,this.pos.y=0),this.width<=10&&(this.width=10),this.height<=10&&(this.height=10)}}},{key:"getAnchorPoint",value:function(){return this.anchor.setLTRB({lt:this.pos,rt:{x:this.pos.x+this.width,y:this.pos.y},rb:{x:this.pos.x+this.width,y:this.pos.y+this.height},lb:{x:this.pos.x,y:this.pos.y+this.height}}),this.anchor}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._calculateMaxAndMin(t),this._setBoundary(t),t.save(),t.lineWidth=this.lineWidth,t.strokeStyle=this.isSelected?this.activeColor:this.color,t.fillStyle=this.color,t.beginPath(),t.rect(this.pos.x,this.pos.y,this.width,this.height),t.closePath(),t.fill(),t.stroke(),t.restore()}},{key:"parseStyle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.x,e=void 0===i?0:i,s=t.y,h=void 0===s?0:s;return{backgroundImage:"linear-gradient( ".concat(this.color," 100%, transparent 0 )"),backgroundPosition:"".concat(this.pos.x-e,"px ").concat(this.pos.y-h,"px"),backgroundSize:"".concat(this.width,"px ").concat(this.height,"px")}}},{key:"toJSON",value:function(){return{pos:this.pos,color:this.color,activeColor:this.activeColor,isActive:this.isActive,isSelected:this.isSelected,width:this.width,height:this.height}}}]),e}(f),C=new P([new O({pos:{x:100,y:100},radius:50,color:"red"}),new O({pos:{x:300,y:100},radius:50,color:"blue"}),new R({pos:{x:200,y:200},width:100,height:100,color:"green"})]);var D=function(){var t=Object(s.useState)(C),i=Object(o.a)(t,2),e=i[0],h=i[1];return Object(M.jsxs)("div",{style:{display:"flex"},children:[Object(M.jsx)(B,{shapes:e}),Object(M.jsx)(A,{onClick:function(){return e.parseStyle(!0)},onSetShapes:function(t){h(t)}})]})},T=(e(24),function(t){t&&t instanceof Function&&e.e(3).then(e.bind(null,26)).then((function(i){var e=i.getCLS,s=i.getFID,h=i.getFCP,a=i.getLCP,n=i.getTTFB;e(t),s(t),h(t),a(t),n(t)}))});n.a.render(Object(M.jsx)(h.a.StrictMode,{children:Object(M.jsx)(D,{})}),document.getElementById("root")),T()}},[[25,1,2]]]);
//# sourceMappingURL=main.c626fceb.chunk.js.map